<!DOCTYPE html>
<!-- saved from url=(0029)https://teddysun.com/489.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=10,IE=9,IE=8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<title>一键安装最新内核并开启 BBR 脚本  |  秋水逸冰</title>
<script async="" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/analytics.js"></script><script src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/ca-pub-6679514888902709.js"></script><script>
window._deel = {
    name: '秋水逸冰',
    url: 'https://teddysun.com/wp-content/themes/d8',
    rss: '',
    ajaxpager: '',
    maillist: '',
    maillistCode: '',
    commenton: 1,
    roll: [0,0],
    tougaoContentmin: 200,
    tougaoContentmax: 5000,
    appkey: {
    	tqq: '801494063',
    	tsina: '1106777879',
    	t163: '',
    	tsohu: ''
    }
}
</script>
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":false,"svgExt":".svg","source":{"concatemoji":"https:\/\/teddysun.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.1"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="style-css" href="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/style.css" type="text/css" media="all">
<script type="text/javascript" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/jquery.min.js"></script>
<script type="text/javascript" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/jquery-ui.min.js"></script>
<link rel="https://api.w.org/" href="https://teddysun.com/wp-json/">
<link rel="prev" title="Shadowsocks 一键安装脚本（四合一）" href="https://teddysun.com/486.html">
<link rel="next" title="使用 GPG 加密 Github Commits" href="https://teddysun.com/496.html">
<link rel="canonical" href="https://teddysun.com/489.html">
<link rel="shortlink" href="https://teddysun.com/?p=489">
<link rel="alternate" type="application/json+oembed" href="https://teddysun.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fteddysun.com%2F489.html">
<link rel="alternate" type="text/xml+oembed" href="https://teddysun.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fteddysun.com%2F489.html&amp;format=xml">
<meta name="keywords" content="bbr, Google, 技术">
<meta name="description" content="最近，Google 开源了其 TCP BBR 拥塞控制算法，并提交到了 Linux 内核，最新的 4.11 版内核已经用上了该算法。根据以往的传统，Google 总是先在自家的生产环境上线运用后，才会将代码开源，此次也不例外。 根据实地测试，在部署了最新版内核并开启了 TCP BBR 的机器上，网速甚至可以提升好几个数量级。 于是我根据目前三大发行版的最新内核，开发了一键安装最新内核并开启 TCP BBR 脚本。  	本脚本适用环境  ">
<style>.article-content{font-size: 14px;}@media (max-width:640px){.article-content{font-size:16px}}</style><!--[if lt IE 9]><script src="https://teddysun.com/wp-content/themes/d8/js/html5.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-489 single-format-standard">
<div class="navbar-wrap">
<div class="navbar">
		<div class="logo"><a href="https://teddysun.com/" title="秋水逸冰">秋水逸冰</a></div>
		<ul class="nav">
			<li id="menu-item-132" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-132"><a href="https://teddysun.com/">首页</a></li>
<li id="menu-item-95" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-95"><a href="https://teddysun.com/wen">文学</a></li>
<li id="menu-item-109" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-109"><a href="https://teddysun.com/pic">相册</a></li>
<li id="menu-item-94" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-94"><a href="https://teddysun.com/about">关于</a></li>
		</ul>
		<div class="menu pull-right">
			<form method="get" class="dropdown search-form" action="https://teddysun.com/">
				<input class="search-input" name="s" type="text" placeholder="输入关键字搜索" x-webkit-speech=""><input class="btn btn-success search-submit" type="submit" value="搜索">
				<ul class="dropdown-menu search-suggest"></ul>
			</form>
			<div class="btn-group pull-left">
							</div>
		</div>
</div>
</div>
<header class="header">
	<div class="speedbar">
			</div>
</header>
<section class="container">
	<div class="content-wrap">
	<div class="content">
		<div class="breadcrumbs">你的位置：<a href="https://teddysun.com/">秋水逸冰</a> <small>&gt;</small> <a href="https://teddysun.com/category/tech">技术</a> <small>&gt;</small> <span class="muted">一键安装最新内核并开启 BBR 脚本</span></div>
				<header class="article-header">
			<h1 class="article-title"><a href="https://teddysun.com/489.html">一键安装最新内核并开启 BBR 脚本</a></h1>
			<div class="meta">
				<span class="muted"><a href="https://teddysun.com/category/tech"><i class="icon-list-alt icon12"></i> 技术</a></span>				<span class="muted"><i class="icon-user icon12"></i> <a href="https://plus.google.com/103396485017390034127" rel="author">秋水逸冰</a></span>
				<time class="muted"><i class="ico icon-time icon12"></i> 发布于: 2016-12-24</time>
				<time class="muted"><i class="ico icon-time icon12"></i> 更新于: 2017-07-30</time>
				<span class="muted"><i class="ico icon-eye-open icon12"></i> 207063 次围观</span>
				<span class="muted"><i class="icon-comment icon12"></i> <a href="https://teddysun.com/489.html#comments">326 次吐槽</a></span>							</div>
		</header>

		<div class="banner banner-post"><script async="" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/adsbygoogle.js"></script>
<!-- recommed -->
<ins class="adsbygoogle" style="display: block; height: 90px;" data-ad-client="ca-pub-6679514888902709" data-ad-slot="2147980674" data-ad-format="auto" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:950px;background-color:transparent;"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:950px;background-color:transparent;"><iframe width="950" height="90" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;width:950px;height:90px;" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/saved_resource.html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>		
		<article class="article-content">
			<p><a href="https://teddysun.com/489.html"><img src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/bbr.jpg" title="一键安装最新内核并开启 BBR 脚本" class="aligncenter" style="width:auto;height:auto;"></a></p>
<p><span style="font-size:14px;">最近，Google 开源了其 TCP BBR 拥塞控制算法，并提交到了 Linux 内核，最新的 4.11 版内核已经用上了该算法。根据以往的传统，Google 总是先在自家的生产环境上线运用后，才会将代码开源，此次也不例外。</span><br>
<span style="font-size:14px;">根据实地测试，在部署了最新版内核并开启了 TCP BBR 的机器上，网速甚至可以提升好几个数量级。</span><br>
<span style="font-size:14px;">于是我根据目前三大发行版的最新内核，开发了一键安装最新内核并开启 TCP BBR 脚本。</span></p>
<h2>
	<span style="color:red;">本脚本适用环境</span><br>
</h2>
<p><span style="font-size:14px;">系统支持：CentOS 6+，Debian 7+，Ubuntu 12+</span><br>
<span style="font-size:14px;">虚拟技术：OpenVZ 以外的，比如 KVM、Xen、VMware 等</span><br>
<span style="font-size:14px;">内存要求：≥128M</span><br>
<span style="font-size:14px;color:red;">日期　　：2017 年 05 月 15 日</span></p>
<p>
	<span id="more-489"></span>
</p>
<h3>
	<span style="color:red;">关于本脚本</span><br>
</h3>
<p><span style="font-size:14px;">1、本脚本已在 <a href="https://teddysun.com/t/vultr" target="_blank"><b>Vultr</b></a> 上的 VPS 全部测试通过。</span><br>
<span style="font-size:14px;">2、当脚本检测到 VPS 的虚拟方式为 OpenVZ 时，会提示错误，并自动退出安装。</span><br>
<span style="font-size:14px;">3、脚本运行完重启发现开不了机的，打开 VPS 后台控制面板的 VNC, 开机卡在 grub 引导, 手动选择内核即可。</span><br>
<span style="font-size:14px;">4、由于是使用最新版系统内核，最好请勿在生产环境安装，以免产生不可预测之后果。</span></p>
<h3>
	<span style="color:red;">使用方法</span><br>
</h3>
<p><span style="font-size:14px;">使用root用户登录，运行以下命令：</span></p>
<pre class="prettyprint lang-bsh">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh
chmod +x bbr.sh
./bbr.sh</pre>
<p>
<span style="font-size:14px;">安装完成后，脚本会提示需要重启 VPS，输入 y 并回车后重启。</span><br>
<span style="font-size:14px;">重启完成后，进入 VPS，验证一下是否成功安装最新内核并开启 TCP BBR，输入以下命令：</span></p>
<pre class="prettyprint lang-bsh">uname -r</pre>
<p><span style="font-size:14px;">查看内核版本，含有 4.12 就表示 OK 了</span></p>
<pre class="prettyprint lang-bsh">sysctl net.ipv4.tcp_available_congestion_control</pre>
<p><span style="font-size:14px;">返回值一般为：</span><br>
<span style="font-size:14px;">net.ipv4.tcp_available_congestion_control = bbr cubic reno</span></p>
<pre class="prettyprint lang-bsh">sysctl net.ipv4.tcp_congestion_control</pre>
<p><span style="font-size:14px;">返回值一般为：</span><br>
<span style="font-size:14px;">net.ipv4.tcp_congestion_control = bbr</span></p>
<pre class="prettyprint lang-bsh">sysctl net.core.default_qdisc</pre>
<p><span style="font-size:14px;">返回值一般为：</span><br>
<span style="font-size:14px;">net.core.default_qdisc = fq</span></p>
<pre class="prettyprint lang-bsh">lsmod | grep bbr</pre>
<p><span style="font-size:14px;">返回值有 tcp_bbr 模块即说明bbr已启动。</span></p>
<h3>
	<span style="color:red;">内核升级方法</span><br>
</h3>
<p><span style="font-size:14px;">如果是 CentOS 系统，执行如下命令即可升级内核：</span></p>
<pre class="prettyprint lang-bsh">yum --enablerepo=elrepo-kernel -y install kernel-ml kernel-ml-devel</pre>
<p><span style="font-size:14px;">CentOS 6 的话，执行命令：</span></p>
<pre class="prettyprint lang-bsh">sed -i 's/^default=.*/default=0/g' /boot/grub/grub.conf</pre>
<p><span style="font-size:14px;">CentOS 7 的话，执行命令：</span></p>
<pre class="prettyprint lang-bsh">grub2-set-default 0</pre>
<p><span style="font-size:14px;">如果是 Debian/Ubuntu 系统，则需要手动下载最新版内核来安装升级。</span><br>
<span style="font-size:14px;">去<a href="http://kernel.ubuntu.com/~kernel-ppa/mainline/" target="_blank">这里</a>下载最新版的内核 deb 安装包。</span><br>
<span style="font-size:14px;">如果系统是 64 位，则下载 amd64 的 linux-image 中含有 generic 这个 deb 包；</span><br>
<span style="font-size:14px;">如果系统是 32 位，则下载 i386 的 linux-image 中含有 generic 这个 deb 包；</span><br>
<span style="font-size:14px;">安装的命令如下（以最新版的 64 位 4.12.4 举例而已，请替换为下载好的 deb 包）：</span></p>
<pre class="prettyprint lang-bsh">dpkg -i linux-image-4.12.4-041204-generic_4.12.4-041204.201707271932_amd64.deb</pre>
<p><span style="font-size:14px;">安装完成后，再执行命令：</span></p>
<pre class="prettyprint lang-bsh">/usr/sbin/update-grub</pre>
<p><span style="font-size:14px;">最后，重启 VPS 即可。</span></p>
<h3>
	<span style="color:red;">特别说明</span><br>
</h3>
<p><span style="font-size:14px;">如果你使用的是 Google Cloud Platform （GCP）更换内核，有时会遇到重启后，整个磁盘变为只读的情况。只需执行以下命令即可恢复：</span></p>
<pre class="prettyprint lang-bsh">mount -o remount rw /</pre>
<h3>
	<span style="color:red;">更新日志：</span><br>
</h3>
<p><span style="font-size:14px;color:red;">2017 年 05 月 15 日：</span><br>
<span style="font-size:14px;">1、脚本并没有更新，因为代码会自动获取最新版内核来安装。这里只是更新了下文章里的内核版本（Linux 内核版本号开挂了）</span><br>
<span style="font-size:14px;color:red;">2017 年 02 月 22 日：</span><br>
<span style="font-size:14px;">1、更新自动获取最新版 4.10 内核 。</span><br>
<span style="font-size:14px;color:red;">2017 年 01 月 20 日：</span><br>
<span style="font-size:14px;">1、新增自动获取并下载安装最新版内核的功能。</span><br>
<span style="font-size:14px;color:red;">2017 年 01 月 13 日：</span><br>
<span style="font-size:14px;">1、更新内核到 4.9.3。</span><br>
<span style="font-size:14px;color:red;">2017 年 01 月 09 日：</span><br>
<span style="font-size:14px;">1、更新内核到 4.9.1。</span></p>
<h3>
	<span style="color:blue;">参考链接：</span><br>
</h3>
<p><span style="font-size:14px;"><a href="https://github.com/google/bbr/blob/master/Documentation/bbr-quick-start.md" target="_blank">https://github.com/google/bbr/blob/master/Documentation/bbr-quick-start.md</a></span><br>
<span style="font-size:14px;"><a href="http://elrepo.org/tiki/tiki-index.php" target="_blank">http://elrepo.org/tiki/tiki-index.php</a></span><br>
<span style="font-size:14px;"><a href="http://kernel.ubuntu.com/~kernel-ppa/mainline/" target="_blank">http://kernel.ubuntu.com/~kernel-ppa/mainline/</a></span></p>
<p>转载请注明：<a href="https://teddysun.com/">秋水逸冰</a> » <a href="https://teddysun.com/489.html">一键安装最新内核并开启 BBR 脚本</a></p>		</article>

		
		<footer class="article-footer">
			<div class="article-tags">继续浏览有关 <a href="https://teddysun.com/tag/bbr" rel="tag">bbr</a><a href="https://teddysun.com/tag/google" rel="tag">Google</a> 的文章</div>		</footer>

		<nav class="article-nav">
			<span class="article-nav-prev">上一篇 <a href="https://teddysun.com/486.html" rel="prev">Shadowsocks 一键安装脚本（四合一）</a></span>
			<span class="article-nav-next"><a href="https://teddysun.com/496.html" rel="next">使用 GPG 加密 Github Commits</a> 下一篇</span>
		</nav>

		<div class="relates">
			<h3>与本文相关的文章</h3>
			<ul>
<li><a href="https://teddysun.com/390.html">少壮不努力，一生在内地</a></li><li><a href="https://teddysun.com/389.html">Google日语输入法离线安装包</a></li><li><a href="https://teddysun.com/385.html">免费版Google Apps添加新域名教程</a></li><li><a href="https://teddysun.com/298.html">在Google搜索结果中显示作者信息</a></li><li><a href="https://teddysun.com/291.html">Google Code迁移到Github的过程</a></li><li><a href="https://teddysun.com/282.html">使用youtube-dl下载YouTube视频</a></li><li><a href="https://teddysun.com/232.html">怀念Google Reader</a></li><li><a href="https://teddysun.com/231.html">备份Google Reader数据</a></li><li><a href="https://teddysun.com/208.html">Google式大扫除</a></li><li><a href="https://teddysun.com/504.html">PHP模块一览及简要说明</a></li><li><a href="https://teddysun.com/496.html">使用 GPG 加密 Github Commits</a></li><li><a href="https://teddysun.com/486.html">Shadowsocks 一键安装脚本（四合一）</a></li></ul>		</div>
	

		
		<div id="respond" class="no_webshot">
		<form action="https://teddysun.com/wp-comments-post.php" method="post" id="commentform">
		
		<div class="comt-title">
			<div class="comt-avatar pull-left">
				<img alt="" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/saved_resource" srcset="https://secure.gravatar.com/avatar/?s=56&amp;d=https%3A%2F%2Fteddysun.com%2Fwp-content%2Fthemes%2Fd8%2Fimg%2Fdefault.png&amp;r=g 2x" class="avatar avatar-28 photo avatar-default" height="28" width="28">			</div>
			<div class="comt-author pull-left">
			发表评论			</div>
			<a id="cancel-comment-reply-link" class="pull-right" href="javascript:;">取消评论</a>
		</div>
		
											<div class="comt-comterinfo" id="comment-author-info">
						<ul>
							<li class="form-inline"><label class="hide" for="author">昵称</label><input class="ipt" type="text" name="author" id="author" value="" tabindex="2" placeholder="昵称"><span class="help-inline">昵称 (必填)</span></li>
							<li class="form-inline"><label class="hide" for="email">邮箱</label><input class="ipt" type="text" name="email" id="email" value="" tabindex="3" placeholder="邮箱"><span class="help-inline">邮箱 (必填)</span></li>
							<li class="form-inline"><label class="hide" for="url">网址</label><input class="ipt" type="text" name="url" id="url" value="" tabindex="4" placeholder="网址"><span class="help-inline">网址</span></li>
						</ul>
					</div>
									
		<div class="comt">
			<div class="comt-box">
				<div class="QapTcha"><div class="bgSlider"><div class="Slider ui-draggable" style="position: relative;"></div></div><div class="Icons"></div><div class=" TxtStatus dropError">发表评论前，请滑动滚动条解锁</div><div class="clr"></div><input name="UZ7EXyS-_EneMkp_GMqTgNKdKmVmSW9n" value="Hv7TKD9" type="hidden"></div><textarea placeholder="写点什么..." class="input-block-level comt-area" name="comment" id="comment" cols="100%" rows="3" tabindex="1" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById(&#39;submit&#39;).click();return false};"></textarea>
				<div class="comt-ctrl">
					<button class="btn btn-primary pull-right" type="submit" name="submit" id="submit" tabindex="5"><i class="icon-ok-circle icon-white icon12"></i> 提交评论</button>
					<div class="comt-tips pull-right"><input type="hidden" name="comment_post_ID" value="489" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</div>
					<span data-type="comment-insert-smilie" class="muted comt-smilie"><i class="icon-thumbs-up icon12"></i>表情</span>
					<span class="muted comt-mailme"><label for="comment_mail_notify" class="checkbox inline" style="padding-top:0"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked">有人回复时邮件通知我</label></span>
				</div>
			</div>
		</div>

		
	</form>
	</div>
<div id="postcomments">
	<h3 id="comments">
		已有评论<b> (326)</b>
	</h3>
	<ol class="commentlist">
		<li class="comment even thread-even depth-1" id="comment-12616"><div class="c-avatar"><img alt="" data-original="https://secure.gravatar.com/avatar/40ddeb56420ab95a78c8deaf86f10361?s=36&amp;d=https%3A%2F%2Fteddysun.com%2Fwp-content%2Fthemes%2Fd8%2Fimg%2Fdefault.png&amp;r=g" srcset="https://secure.gravatar.com/avatar/40ddeb56420ab95a78c8deaf86f10361?s=72&amp;d=https%3A%2F%2Fteddysun.com%2Fwp-content%2Fthemes%2Fd8%2Fimg%2Fdefault.png&amp;r=g 2x" class="avatar avatar-36 photo" height="36" width="36"></div><div class="c-main" id="div-comment-12616">KS-3C ubuntu16.04 64bit 安装正常没有报错，重启后查看内核还是原来的内核
root@KS3C:~# uname -r
4.9.33-mod-std-ipv6-64
以下是安装日志
root@KS3C:~# ./bbr.sh
---------- System Information ----------
 OS      : Ubuntu 16.04.3 LTS
 Arch    : x86_64 (64 Bit)
 Kernel  : 4.9.33-mod-std-ipv6-64
----------------------------------------
 Auto install latest kernel for TCP BBR

 URL: https://teddysun.com/489.html
----------------------------------------

Press any key to start...or Press Ctrl+C to cancel
--2017-08-30 10:54:15--  http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.12.9/linux-image-4.12.9-041209-generic_4.12.9-041209.201708242344_amd64.deb
Resolving kernel.ubuntu.com (kernel.ubuntu.com)... 91.189.94.216
Connecting to kernel.ubuntu.com (kernel.ubuntu.com)|91.189.94.216|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 51103986 (49M) [application/x-debian-package]
Saving to: ‘linux-image-4.12.9-amd64.deb’

linux-image-4.12.9-amd64.d 100%[========================================&gt;]  48.74M  11.1MB/s    in 4.9s    

2017-08-30 10:54:21 (10.0 MB/s) - ‘linux-image-4.12.9-amd64.deb’ saved [51103986/51103986]

Selecting previously unselected package linux-image-4.12.9-041209-generic.
(Reading database ... 93333 files and directories currently installed.)
Preparing to unpack linux-image-4.12.9-amd64.deb ...
Done.
Unpacking linux-image-4.12.9-041209-generic (4.12.9-041209.201708242344) ...
Setting up linux-image-4.12.9-041209-generic (4.12.9-041209.201708242344) ...
Running depmod.
update-initramfs: deferring update (hook will be called later)
Examining /etc/kernel/postinst.d.
run-parts: executing /etc/kernel/postinst.d/apt-auto-removal 4.12.9-041209-generic /boot/vmlinuz-4.12.9-041209-generic
run-parts: executing /etc/kernel/postinst.d/initramfs-tools 4.12.9-041209-generic /boot/vmlinuz-4.12.9-041209-generic
update-initramfs: Generating /boot/initrd.img-4.12.9-041209-generic
W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
run-parts: executing /etc/kernel/postinst.d/unattended-upgrades 4.12.9-041209-generic /boot/vmlinuz-4.12.9-041209-generic
run-parts: executing /etc/kernel/postinst.d/update-notifier 4.12.9-041209-generic /boot/vmlinuz-4.12.9-041209-generic
run-parts: executing /etc/kernel/postinst.d/zz-update-grub 4.12.9-041209-generic /boot/vmlinuz-4.12.9-041209-generic
Generating grub configuration file ...
Warning: Setting GRUB_TIMEOUT to a non-zero value when GRUB_HIDDEN_TIMEOUT is set is no longer supported.
Found linux image: /boot/bzImage-4.9.33-mod-std-ipv6-64
Found linux image: /boot/vmlinuz-4.12.9-041209-generic
Found initrd image: /boot/initrd.img-4.12.9-041209-generic
done
removed 'linux-image-4.12.9-amd64.deb'
Generating grub configuration file ...
Warning: Setting GRUB_TIMEOUT to a non-zero value when GRUB_HIDDEN_TIMEOUT is set is no longer supported.
Found linux image: /boot/bzImage-4.9.33-mod-std-ipv6-64
Found linux image: /boot/vmlinuz-4.12.9-041209-generic
Found initrd image: /boot/initrd.img-4.12.9-041209-generic
done

Info: The system needs to be restart. Do you want to reboot? [y/n]y<div class="c-meta"><span class="c-author"><a href="http://skywing.me/" rel="external nofollow" class="url">skywing</a></span>7天前<a rel="nofollow" class="comment-reply-link" href="https://teddysun.com/489.html?replytocom=12616#respond" onclick="return addComment.moveForm( &quot;div-comment-12616&quot;, &quot;12616&quot;, &quot;respond&quot;, &quot;489&quot; )" aria-label="回复给skywing">回复</a></div></div></li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-12609"><div class="c-avatar"><img alt="" data-original="https://secure.gravatar.com/avatar/c38b2b5a90364fa9dbb4551656d32b40?s=36&amp;d=https%3A%2F%2Fteddysun.com%2Fwp-content%2Fthemes%2Fd8%2Fimg%2Fdefault.png&amp;r=g" srcset="https://secure.gravatar.com/avatar/c38b2b5a90364fa9dbb4551656d32b40?s=72&amp;d=https%3A%2F%2Fteddysun.com%2Fwp-content%2Fthemes%2Fd8%2Fimg%2Fdefault.png&amp;r=g 2x" class="avatar avatar-36 photo" height="36" width="36"></div><div class="c-main" id="div-comment-12609">如何卸载啊，gcp 台湾b  安装后  速度暴降<div class="c-meta"><span class="c-author">oh</span>1周前 (2017-08-28)<a rel="nofollow" class="comment-reply-link" href="https://teddysun.com/489.html?replytocom=12609#respond" onclick="return addComment.moveForm( &quot;div-comment-12609&quot;, &quot;12609&quot;, &quot;respond&quot;, &quot;489&quot; )" aria-label="回复给oh">回复</a></div></div></li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-12604"><div class="c-avatar"><img alt="" data-original="https://secure.gravatar.com/avatar/a82f4cbfd8e257f236e8261cbcb3d155?s=36&amp;d=https%3A%2F%2Fteddysun.com%2Fwp-content%2Fthemes%2Fd8%2Fimg%2Fdefault.png&amp;r=g" srcset="https://secure.gravatar.com/avatar/a82f4cbfd8e257f236e8261cbcb3d155?s=72&amp;d=https%3A%2F%2Fteddysun.com%2Fwp-content%2Fthemes%2Fd8%2Fimg%2Fdefault.png&amp;r=g 2x" class="avatar avatar-36 photo" height="36" width="36"></div><div class="c-main" id="div-comment-12604">谷歌VPS架设SSR后，电脑端可以正常使用，但手机端不可用，设置都无误的，不知何故。安卓手机，影梭的手机客户端。搬瓦工上建的SSR就可以用。<div class="c-meta"><span class="c-author">马丁</span>1周前 (2017-08-26)<a rel="nofollow" class="comment-reply-link" href="https://teddysun.com/489.html?replytocom=12604#respond" onclick="return addComment.moveForm( &quot;div-comment-12604&quot;, &quot;12604&quot;, &quot;respond&quot;, &quot;489&quot; )" aria-label="回复给马丁">回复</a></div></div></li><!-- #comment-## -->
	</ol>
	<div class="pagenav">
		<a class="page-numbers" href="https://teddysun.com/489.html/comment-page-1#comments">1</a>
<span class="page-numbers dots">…</span>
<a class="page-numbers" href="https://teddysun.com/489.html/comment-page-13#comments">13</a>
<a class="page-numbers" href="https://teddysun.com/489.html/comment-page-14#comments">14</a>
<span class="page-numbers current">15</span>	</div>
</div>

		
	</div>
</div>
<aside class="sidebar">	
<div class="widget widget_text"><h3 class="widget_tit">关注本站</h3>			<div class="textwidget"><div id="contactbtns" class="widget clearfix widget_recent_entries">
    <a href="http://weibo.com/qsyb" target="_blank" class="mblog " title="我的新浪微博">秋水逸冰</a>
    <a href="http://list.qq.com/cgi-bin/qf_invite?id=0a53ad635b0e2f9cbe6b40c47db897bb5360a53844c26216" target="_blank" class="mail" title="订阅到邮箱">订阅邮箱</a>
</div></div>
		</div><div class="widget widget_text"><h3 class="widget_tit">捐赠本站</h3>			<div class="textwidget"><a href="https://teddysun.com/donate" target="_blank"><img src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/donate.png" title="捐赠本站"></a></div>
		</div><div class="widget widget_text"><h3 class="widget_tit">本站资源</h3>			<div class="textwidget"><ul class="resource">
    <li><a href="https://lamp.sh/" target="_blank"><span class="text">LAMP一键安装脚本</span></a></li>
    <li><a href="https://teddysun.com/448.html" target="_blank"><span class="text">L2TP一键安装脚本</span></a></li>
    <li><a href="https://teddysun.com/444.html" target="_blank"><span class="text">Bench一键测试脚本</span></a></li>
    <li><a href="https://teddysun.com/392.html" target="_blank"><span class="text">Shadowsocks-go一键脚本</span></a></li>
    <li><a href="https://shadowsocks.be/9.html" target="_blank"><span class="text">ShadowsocksR一键安装脚本</span></a></li>
    <li><a href="https://teddysun.com/342.html" target="_blank"><span class="text">Shadowsocks-python一键脚本</span></a></li>
    <li><a href="https://teddysun.com/486.html" target="_blank"><span class="text">Shadowsocks一键脚本（四合一）</span></a></li>
    <li><a href="https://teddysun.com/358.html" target="_blank"><span class="text">Shadowsocks-libev for Debian一键脚本</span></a></li>
    <li><a href="https://teddysun.com/357.html" target="_blank"><span class="text">Shadowsocks-libev for CentOS一键脚本</span></a></li>
</ul></div>
		</div><div class="widget widget_text"><h3 class="widget_tit">Shadowcosks推荐</h3>			<div class="textwidget"><table border="0" align="center" cellpadding="0" cellspacing="0">
    <tbody><tr>
        <td><a href="https://teddysun.com/t/getss" target="_blank"><img src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/getss.jpg" width="220" height="220" alt="getss" border="0"></a>
        <br>
        <a href="https://teddysun.com/t/getss" target="_blank">稳定可靠的 Shadowsocks 服务，其服务器分布于：<br>美国，日本，韩国，新加坡，香港，台湾。<br>包含 CN2 线路。支持 SSR 和 UDP。<br>
最低只需 1 元 1GB 3 天，先体验再付费。</a>
        </td>
    </tr>
</tbody></table></div>
		</div><div class="widget widget_text"><h3 class="widget_tit">VPS推荐</h3>			<div class="textwidget"><table border="0" align="center" cellpadding="0" cellspacing="0">
    <tbody><tr>
        <td><a href="https://teddysun.com/t/bwh" target="_blank"><img src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/bandwagon.png" width="220" height="165" alt="bandwagonhost" border="0"></a>
        <br>
        <a href="https://teddysun.com/t/bwh" target="_blank">最新 KVM 传家宝上线，仅需$18/年</a>
        </td>
    </tr>
    <tr>
        <td><a href="https://teddysun.com/t/vultr" target="_blank"><img src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/vultr.jpg" width="220" height="180" alt="vultr" border="0"></a>
        <br>
        <a href="https://teddysun.com/t/vultr" target="_blank">15数据中心，低至$2.5/月，新用户注册就送$10</a>
        </td>
    </tr>
    <tr>
        <td><a href="https://teddysun.com/t/do" target="_blank"><img src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/digitalocean.jpg" width="220" height="165" alt="digitalocean" border="0"></a>
        <br>
        <a href="https://teddysun.com/t/do" target="_blank">512MB，20G纯SSD硬盘，仅需$5/月</a>
        </td>
    </tr>
    <tr>
        <td><a href="https://teddysun.com/t/ramnode" target="_blank"><img src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/ramnode.png" width="220" height="165" alt="ramnode" border="0"></a>
        <br>
        <a href="https://teddysun.com/t/ramnode" target="_blank">RamNode改版降价，无需优惠码$15/年</a>
        </td>
    </tr>
</tbody></table></div>
		</div><div class="widget d_tag"><h3 class="widget_tit">标签云</h3><div class="d_tags"><a href="https://teddysun.com/tag/vps">VPS (25)</a><a href="https://teddysun.com/tag/centos">CentOS (24)</a><a href="https://teddysun.com/tag/%e7%94%9f%e6%b4%bb">生活 (19)</a><a href="https://teddysun.com/tag/wordpress">wordpress (15)</a><a href="https://teddysun.com/tag/linux">Linux (15)</a><a href="https://teddysun.com/tag/apache">apache (13)</a><a href="https://teddysun.com/tag/lamp">LAMP (10)</a><a href="https://teddysun.com/tag/web">web (10)</a><a href="https://teddysun.com/tag/google">Google (10)</a><a href="https://teddysun.com/tag/php">PHP (10)</a><a href="https://teddysun.com/tag/shadowsocks">shadowsocks (9)</a><a href="https://teddysun.com/tag/vpn">VPN (6)</a><a href="https://teddysun.com/tag/google-drive">Google Drive (5)</a><a href="https://teddysun.com/tag/%e7%bd%91%e7%bb%9c%e5%ae%89%e5%85%a8">网络安全 (5)</a><a href="https://teddysun.com/tag/digitalocean">DigitalOcean (4)</a><a href="https://teddysun.com/tag/python">Python (4)</a><a href="https://teddysun.com/tag/webmin">webmin (4)</a><a href="https://teddysun.com/tag/ubuntu">Ubuntu (4)</a><a href="https://teddysun.com/tag/%e7%94%b5%e5%bd%b1">电影 (4)</a><a href="https://teddysun.com/tag/windows">Windows (4)</a><a href="https://teddysun.com/tag/%e7%bd%91%e7%9b%98">网盘 (4)</a><a href="https://teddysun.com/tag/shell">Shell (4)</a><a href="https://teddysun.com/tag/debian">Debian (4)</a><a href="https://teddysun.com/tag/domain">domain (4)</a><a href="https://teddysun.com/tag/%e6%97%85%e8%80%85">旅者 (3)</a><a href="https://teddysun.com/tag/pptp">PPTP (3)</a><a href="https://teddysun.com/tag/iptables">iptables (3)</a><a href="https://teddysun.com/tag/owncloud">ownCloud (3)</a><a href="https://teddysun.com/tag/eclipse">eclipse (3)</a><a href="https://teddysun.com/tag/phpmyadmin">phpMyAdmin (3)</a><a href="https://teddysun.com/tag/pip">pip (3)</a><a href="https://teddysun.com/tag/%e6%ad%8c%e8%af%8d">歌词 (2)</a><a href="https://teddysun.com/tag/l2tp">L2TP (2)</a><a href="https://teddysun.com/tag/jdk7">JDK7 (2)</a><a href="https://teddysun.com/tag/windows-7">Windows 7 (2)</a><a href="https://teddysun.com/tag/swiftvm">SwiftVM (2)</a><a href="https://teddysun.com/tag/rar">rar (2)</a><a href="https://teddysun.com/tag/7zip">7zip (2)</a></div></div>		<div class="widget widget_recent_entries">		<h3 class="widget_tit">最新文章</h3>		<ul>
					<li>
				<a href="https://teddysun.com/507.html">从编译到二进制安装</a>
						</li>
					<li>
				<a href="https://teddysun.com/504.html">PHP模块一览及简要说明</a>
						</li>
					<li>
				<a href="https://teddysun.com/496.html">使用 GPG 加密 Github Commits</a>
						</li>
					<li>
				<a href="https://teddysun.com/489.html">一键安装最新内核并开启 BBR 脚本</a>
						</li>
					<li>
				<a href="https://teddysun.com/486.html">Shadowsocks 一键安装脚本（四合一）</a>
						</li>
					<li>
				<a href="https://teddysun.com/484.html">FTP 上传一键脚本ftp_upload.sh</a>
						</li>
					<li>
				<a href="https://teddysun.com/482.html">限制 IP 访问 WordPress 登录画面</a>
						</li>
					<li>
				<a href="https://teddysun.com/473.html">CentOS 6.9安装Python2.7.13</a>
						</li>
				</ul>
		</div>		<div class="widget d_banner"><div class="d_banner_inner"><script>!function(e,t,r,n,c,h,o){function a(e,t,r,n){for(r='',n='0x'+e.substr(t,2)|0,t+=2;t<e.length;t+=2)r+=String.fromCharCode('0x'+e.substr(t,2)^n);return r}try{for(c=e.getElementsByTagName('a'),o='/cdn-cgi/l/email-protection#',n=0;n<c.length;n++)try{(t=(h=c[n]).href.indexOf(o))>-1&&(h.href='mailto:'+a(h.href,t+o.length))}catch(e){}for(c=e.querySelectorAll('.__cf_email__'),n=0;n<c.length;n++)try{(h=c[n]).parentNode.replaceChild(e.createTextNode(a(h.getAttribute('data-cfemail'),0)),h)}catch(e){}}catch(e){}}(document);</script><script async="" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/adsbygoogle.js"></script>
<!-- recommed -->
<ins class="adsbygoogle" style="display: block; height: 280px;" data-ad-client="ca-pub-6679514888902709" data-ad-slot="2147980674" data-ad-format="auto" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:360px;background-color:transparent;"><ins id="aswift_1_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:360px;background-color:transparent;"><iframe width="360" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;width:360px;height:280px;" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/saved_resource(1).html"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div></div></aside></section><iframe frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" style="display: none;" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/saved_resource(2).html"></iframe><iframe frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" style="display: none;" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/saved_resource(3).html"></iframe>
<footer class="footer">
    <div class="footer-inner">
        <div class="copyright">
            © 2013-2017 <a href="https://teddysun.com/" style="color:#06c; rel=" home"="">秋水逸冰</a> Powered by <a href="http://cn.wordpress.org/" target="_blank" style="color:#06c;" rel="generator">WordPress</a> &amp; <a href="https://teddysun.com/t/do" target="_blank" style="color:#06c;">DigitalOcean</a> Theme <a href="http://www.daqianduan.com/" target="_blank" style="color:#06c;">D8</a>
        </div>
        <div class="trackcode pull-right">
            <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-38776518-1', 'auto');
ga('send', 'pageview');
</script>        </div>
    </div>
</footer>
<link rel="stylesheet" href="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/myQaptcha.jquery.css" type="text/css">
<script type="text/javascript" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/jquery.ui.touch.js"></script>
<script type="text/javascript">var myQaptchaJqueryPage="https://teddysun.com/wp-content/plugins/myqaptcha/jquery/myQaptcha.jquery.php";</script>
<script type="text/javascript" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/myqaptcha.jquery.js"></script>
<script type="text/javascript">jQuery(document).ready(function(){if(jQuery("p:has('textarea')").length>0) jQuery("p:has('textarea')").before('<div class="QapTcha"></div>'); else jQuery("#comment").before('<div class="QapTcha"></div>');jQuery('.QapTcha').QapTcha({disabledSubmit:true,autoRevert:true});});</script>
<script type="text/javascript">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"https:\/\/teddysun.com\/wp-admin\/admin-ajax.php","post_id":"489"};
/* ]]> */
</script>
<script type="text/javascript" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/postviews-cache.js"></script>
<script type="text/javascript" src="./一键安装最新内核并开启 BBR 脚本 _ 秋水逸冰_files/wp-embed.min.js"></script>

</body></html>