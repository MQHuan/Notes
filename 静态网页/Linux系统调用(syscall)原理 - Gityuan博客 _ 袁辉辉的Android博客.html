<!DOCTYPE html>
<!-- saved from url=(0038)http://gityuan.com/2016/05/21/syscall/ -->
<html lang="en" class="gr__gityuan_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="anchorjs"></style><style class="darkreader darkreader--sync" media="screen"></style><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen"></style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style><style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #0b0b0c !important;
}
html, body, input, textarea, select, button {
    background-color: #0b0b0c;
}
html, body, input, textarea, select, button {
    border-color: #4c4b49;
    color: #e0dcd5;
}
a {
    color: #5e7ea2;
}
table {
    border-color: #41403e;
}
::placeholder {
    color: #ada9a2;
}
::selection {
    background-color: #29486f;
    color: #f8f5ee;
}
::-moz-selection {
    background-color: #29486f;
    color: #f8f5ee;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #484927 !important;
    color: #e0dcd5 !important;
}
::-webkit-scrollbar {
    background-color: #0f0f11;
    color: #b9b5ae;
}
::-webkit-scrollbar-thumb {
    background-color: #1c1d20;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #232528;
}
::-webkit-scrollbar-thumb:active {
    background-color: #2c3035;
}
::-webkit-scrollbar-corner {
    background-color: #0b0b0c;
}
* {
    scrollbar-color: #1c1d20 #0f0f11;
}</style>
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Cache-Control" content="max-age=36000">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="gityuan">
    <meta name="keyword" content="Android,Gityuan,Android博客,Android源码,袁辉辉">
    <meta name="description" content="Android架构,Gityuan,Android博客,Android源码,袁辉辉">
    <meta name="baidu-site-verification" content="LToTaY8RGk">
    <link rel="shortcut icon" href="http://gityuan.com/images/favicon.ico">
    <title>Linux系统调用(syscall)原理 - Gityuan博客 | 袁辉辉的Android博客</title>

    <link rel="canonical" href="http://gityuan.com/2016/05/21/syscall/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/bootstrap.min.css"><style class="darkreader darkreader--sync" media="screen"></style>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/hux-blog.min.css"><style class="darkreader darkreader--sync" media="screen"></style>

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/syntax.css"><style class="darkreader darkreader--sync" media="screen"></style>

    <!-- Custom Fonts -->
    <!-- change font-awesome CDN to qiniu -->
    <link href="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/font-awesome.min.css" rel="stylesheet" type="text/css"><style class="darkreader darkreader--cors" media="screen">.fa{display:inline-block;font:normal normal normal 14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-lg{font-size:1.33333333em;line-height:.75em;vertical-align:-15%}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-fw{width:1.28571429em;text-align:center}.fa-ul{padding-left:0;margin-left:2.14285714em;list-style-type:none}.fa-ul>li{position:relative}.fa-li{position:absolute;left:-2.14285714em;width:2.14285714em;top:.14285714em;text-align:center}.fa-li.fa-lg{left:-1.85714286em}.fa-border{padding:.2em .25em .15em;border:solid .08em #eee;border-radius:.1em}.pull-right{float:right}.pull-left{float:left}.fa.pull-left{margin-right:.3em}.fa.pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fa-rotate-90{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=1);-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2);-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);-webkit-transform:rotate(270deg);-ms-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1);-webkit-transform:scale(-1, 1);-ms-transform:scale(-1, 1);transform:scale(-1, 1)}.fa-flip-vertical{filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1);-webkit-transform:scale(1, -1);-ms-transform:scale(1, -1);transform:scale(1, -1)}:root .fa-rotate-90,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-flip-horizontal,:root .fa-flip-vertical{filter:none}.fa-stack{position:relative;display:inline-block;width:2em;height:2em;line-height:2em;vertical-align:middle}.fa-stack-1x,.fa-stack-2x{position:absolute;left:0;width:100%;text-align:center}.fa-stack-1x{line-height:inherit}.fa-stack-2x{font-size:2em}.fa-inverse{color:#fff}.fa-glass:before{content:"\f000"}.fa-music:before{content:"\f001"}.fa-search:before{content:"\f002"}.fa-envelope-o:before{content:"\f003"}.fa-heart:before{content:"\f004"}.fa-star:before{content:"\f005"}.fa-star-o:before{content:"\f006"}.fa-user:before{content:"\f007"}.fa-film:before{content:"\f008"}.fa-th-large:before{content:"\f009"}.fa-th:before{content:"\f00a"}.fa-th-list:before{content:"\f00b"}.fa-check:before{content:"\f00c"}.fa-remove:before,.fa-close:before,.fa-times:before{content:"\f00d"}.fa-search-plus:before{content:"\f00e"}.fa-search-minus:before{content:"\f010"}.fa-power-off:before{content:"\f011"}.fa-signal:before{content:"\f012"}.fa-gear:before,.fa-cog:before{content:"\f013"}.fa-trash-o:before{content:"\f014"}.fa-home:before{content:"\f015"}.fa-file-o:before{content:"\f016"}.fa-clock-o:before{content:"\f017"}.fa-road:before{content:"\f018"}.fa-download:before{content:"\f019"}.fa-arrow-circle-o-down:before{content:"\f01a"}.fa-arrow-circle-o-up:before{content:"\f01b"}.fa-inbox:before{content:"\f01c"}.fa-play-circle-o:before{content:"\f01d"}.fa-rotate-right:before,.fa-repeat:before{content:"\f01e"}.fa-refresh:before{content:"\f021"}.fa-list-alt:before{content:"\f022"}.fa-lock:before{content:"\f023"}.fa-flag:before{content:"\f024"}.fa-headphones:before{content:"\f025"}.fa-volume-off:before{content:"\f026"}.fa-volume-down:before{content:"\f027"}.fa-volume-up:before{content:"\f028"}.fa-qrcode:before{content:"\f029"}.fa-barcode:before{content:"\f02a"}.fa-tag:before{content:"\f02b"}.fa-tags:before{content:"\f02c"}.fa-book:before{content:"\f02d"}.fa-bookmark:before{content:"\f02e"}.fa-print:before{content:"\f02f"}.fa-camera:before{content:"\f030"}.fa-font:before{content:"\f031"}.fa-bold:before{content:"\f032"}.fa-italic:before{content:"\f033"}.fa-text-height:before{content:"\f034"}.fa-text-width:before{content:"\f035"}.fa-align-left:before{content:"\f036"}.fa-align-center:before{content:"\f037"}.fa-align-right:before{content:"\f038"}.fa-align-justify:before{content:"\f039"}.fa-list:before{content:"\f03a"}.fa-dedent:before,.fa-outdent:before{content:"\f03b"}.fa-indent:before{content:"\f03c"}.fa-video-camera:before{content:"\f03d"}.fa-photo:before,.fa-image:before,.fa-picture-o:before{content:"\f03e"}.fa-pencil:before{content:"\f040"}.fa-map-marker:before{content:"\f041"}.fa-adjust:before{content:"\f042"}.fa-tint:before{content:"\f043"}.fa-edit:before,.fa-pencil-square-o:before{content:"\f044"}.fa-share-square-o:before{content:"\f045"}.fa-check-square-o:before{content:"\f046"}.fa-arrows:before{content:"\f047"}.fa-step-backward:before{content:"\f048"}.fa-fast-backward:before{content:"\f049"}.fa-backward:before{content:"\f04a"}.fa-play:before{content:"\f04b"}.fa-pause:before{content:"\f04c"}.fa-stop:before{content:"\f04d"}.fa-forward:before{content:"\f04e"}.fa-fast-forward:before{content:"\f050"}.fa-step-forward:before{content:"\f051"}.fa-eject:before{content:"\f052"}.fa-chevron-left:before{content:"\f053"}.fa-chevron-right:before{content:"\f054"}.fa-plus-circle:before{content:"\f055"}.fa-minus-circle:before{content:"\f056"}.fa-times-circle:before{content:"\f057"}.fa-check-circle:before{content:"\f058"}.fa-question-circle:before{content:"\f059"}.fa-info-circle:before{content:"\f05a"}.fa-crosshairs:before{content:"\f05b"}.fa-times-circle-o:before{content:"\f05c"}.fa-check-circle-o:before{content:"\f05d"}.fa-ban:before{content:"\f05e"}.fa-arrow-left:before{content:"\f060"}.fa-arrow-right:before{content:"\f061"}.fa-arrow-up:before{content:"\f062"}.fa-arrow-down:before{content:"\f063"}.fa-mail-forward:before,.fa-share:before{content:"\f064"}.fa-expand:before{content:"\f065"}.fa-compress:before{content:"\f066"}.fa-plus:before{content:"\f067"}.fa-minus:before{content:"\f068"}.fa-asterisk:before{content:"\f069"}.fa-exclamation-circle:before{content:"\f06a"}.fa-gift:before{content:"\f06b"}.fa-leaf:before{content:"\f06c"}.fa-fire:before{content:"\f06d"}.fa-eye:before{content:"\f06e"}.fa-eye-slash:before{content:"\f070"}.fa-warning:before,.fa-exclamation-triangle:before{content:"\f071"}.fa-plane:before{content:"\f072"}.fa-calendar:before{content:"\f073"}.fa-random:before{content:"\f074"}.fa-comment:before{content:"\f075"}.fa-magnet:before{content:"\f076"}.fa-chevron-up:before{content:"\f077"}.fa-chevron-down:before{content:"\f078"}.fa-retweet:before{content:"\f079"}.fa-shopping-cart:before{content:"\f07a"}.fa-folder:before{content:"\f07b"}.fa-folder-open:before{content:"\f07c"}.fa-arrows-v:before{content:"\f07d"}.fa-arrows-h:before{content:"\f07e"}.fa-bar-chart-o:before,.fa-bar-chart:before{content:"\f080"}.fa-twitter-square:before{content:"\f081"}.fa-facebook-square:before{content:"\f082"}.fa-camera-retro:before{content:"\f083"}.fa-key:before{content:"\f084"}.fa-gears:before,.fa-cogs:before{content:"\f085"}.fa-comments:before{content:"\f086"}.fa-thumbs-o-up:before{content:"\f087"}.fa-thumbs-o-down:before{content:"\f088"}.fa-star-half:before{content:"\f089"}.fa-heart-o:before{content:"\f08a"}.fa-sign-out:before{content:"\f08b"}.fa-linkedin-square:before{content:"\f08c"}.fa-thumb-tack:before{content:"\f08d"}.fa-external-link:before{content:"\f08e"}.fa-sign-in:before{content:"\f090"}.fa-trophy:before{content:"\f091"}.fa-github-square:before{content:"\f092"}.fa-upload:before{content:"\f093"}.fa-lemon-o:before{content:"\f094"}.fa-phone:before{content:"\f095"}.fa-square-o:before{content:"\f096"}.fa-bookmark-o:before{content:"\f097"}.fa-phone-square:before{content:"\f098"}.fa-twitter:before{content:"\f099"}.fa-facebook:before{content:"\f09a"}.fa-github:before{content:"\f09b"}.fa-unlock:before{content:"\f09c"}.fa-credit-card:before{content:"\f09d"}.fa-rss:before{content:"\f09e"}.fa-hdd-o:before{content:"\f0a0"}.fa-bullhorn:before{content:"\f0a1"}.fa-bell:before{content:"\f0f3"}.fa-certificate:before{content:"\f0a3"}.fa-hand-o-right:before{content:"\f0a4"}.fa-hand-o-left:before{content:"\f0a5"}.fa-hand-o-up:before{content:"\f0a6"}.fa-hand-o-down:before{content:"\f0a7"}.fa-arrow-circle-left:before{content:"\f0a8"}.fa-arrow-circle-right:before{content:"\f0a9"}.fa-arrow-circle-up:before{content:"\f0aa"}.fa-arrow-circle-down:before{content:"\f0ab"}.fa-globe:before{content:"\f0ac"}.fa-wrench:before{content:"\f0ad"}.fa-tasks:before{content:"\f0ae"}.fa-filter:before{content:"\f0b0"}.fa-briefcase:before{content:"\f0b1"}.fa-arrows-alt:before{content:"\f0b2"}.fa-group:before,.fa-users:before{content:"\f0c0"}.fa-chain:before,.fa-link:before{content:"\f0c1"}.fa-cloud:before{content:"\f0c2"}.fa-flask:before{content:"\f0c3"}.fa-cut:before,.fa-scissors:before{content:"\f0c4"}.fa-copy:before,.fa-files-o:before{content:"\f0c5"}.fa-paperclip:before{content:"\f0c6"}.fa-save:before,.fa-floppy-o:before{content:"\f0c7"}.fa-square:before{content:"\f0c8"}.fa-navicon:before,.fa-reorder:before,.fa-bars:before{content:"\f0c9"}.fa-list-ul:before{content:"\f0ca"}.fa-list-ol:before{content:"\f0cb"}.fa-strikethrough:before{content:"\f0cc"}.fa-underline:before{content:"\f0cd"}.fa-table:before{content:"\f0ce"}.fa-magic:before{content:"\f0d0"}.fa-truck:before{content:"\f0d1"}.fa-pinterest:before{content:"\f0d2"}.fa-pinterest-square:before{content:"\f0d3"}.fa-google-plus-square:before{content:"\f0d4"}.fa-google-plus:before{content:"\f0d5"}.fa-money:before{content:"\f0d6"}.fa-caret-down:before{content:"\f0d7"}.fa-caret-up:before{content:"\f0d8"}.fa-caret-left:before{content:"\f0d9"}.fa-caret-right:before{content:"\f0da"}.fa-columns:before{content:"\f0db"}.fa-unsorted:before,.fa-sort:before{content:"\f0dc"}.fa-sort-down:before,.fa-sort-desc:before{content:"\f0dd"}.fa-sort-up:before,.fa-sort-asc:before{content:"\f0de"}.fa-envelope:before{content:"\f0e0"}.fa-linkedin:before{content:"\f0e1"}.fa-rotate-left:before,.fa-undo:before{content:"\f0e2"}.fa-legal:before,.fa-gavel:before{content:"\f0e3"}.fa-dashboard:before,.fa-tachometer:before{content:"\f0e4"}.fa-comment-o:before{content:"\f0e5"}.fa-comments-o:before{content:"\f0e6"}.fa-flash:before,.fa-bolt:before{content:"\f0e7"}.fa-sitemap:before{content:"\f0e8"}.fa-umbrella:before{content:"\f0e9"}.fa-paste:before,.fa-clipboard:before{content:"\f0ea"}.fa-lightbulb-o:before{content:"\f0eb"}.fa-exchange:before{content:"\f0ec"}.fa-cloud-download:before{content:"\f0ed"}.fa-cloud-upload:before{content:"\f0ee"}.fa-user-md:before{content:"\f0f0"}.fa-stethoscope:before{content:"\f0f1"}.fa-suitcase:before{content:"\f0f2"}.fa-bell-o:before{content:"\f0a2"}.fa-coffee:before{content:"\f0f4"}.fa-cutlery:before{content:"\f0f5"}.fa-file-text-o:before{content:"\f0f6"}.fa-building-o:before{content:"\f0f7"}.fa-hospital-o:before{content:"\f0f8"}.fa-ambulance:before{content:"\f0f9"}.fa-medkit:before{content:"\f0fa"}.fa-fighter-jet:before{content:"\f0fb"}.fa-beer:before{content:"\f0fc"}.fa-h-square:before{content:"\f0fd"}.fa-plus-square:before{content:"\f0fe"}.fa-angle-double-left:before{content:"\f100"}.fa-angle-double-right:before{content:"\f101"}.fa-angle-double-up:before{content:"\f102"}.fa-angle-double-down:before{content:"\f103"}.fa-angle-left:before{content:"\f104"}.fa-angle-right:before{content:"\f105"}.fa-angle-up:before{content:"\f106"}.fa-angle-down:before{content:"\f107"}.fa-desktop:before{content:"\f108"}.fa-laptop:before{content:"\f109"}.fa-tablet:before{content:"\f10a"}.fa-mobile-phone:before,.fa-mobile:before{content:"\f10b"}.fa-circle-o:before{content:"\f10c"}.fa-quote-left:before{content:"\f10d"}.fa-quote-right:before{content:"\f10e"}.fa-spinner:before{content:"\f110"}.fa-circle:before{content:"\f111"}.fa-mail-reply:before,.fa-reply:before{content:"\f112"}.fa-github-alt:before{content:"\f113"}.fa-folder-o:before{content:"\f114"}.fa-folder-open-o:before{content:"\f115"}.fa-smile-o:before{content:"\f118"}.fa-frown-o:before{content:"\f119"}.fa-meh-o:before{content:"\f11a"}.fa-gamepad:before{content:"\f11b"}.fa-keyboard-o:before{content:"\f11c"}.fa-flag-o:before{content:"\f11d"}.fa-flag-checkered:before{content:"\f11e"}.fa-terminal:before{content:"\f120"}.fa-code:before{content:"\f121"}.fa-mail-reply-all:before,.fa-reply-all:before{content:"\f122"}.fa-star-half-empty:before,.fa-star-half-full:before,.fa-star-half-o:before{content:"\f123"}.fa-location-arrow:before{content:"\f124"}.fa-crop:before{content:"\f125"}.fa-code-fork:before{content:"\f126"}.fa-unlink:before,.fa-chain-broken:before{content:"\f127"}.fa-question:before{content:"\f128"}.fa-info:before{content:"\f129"}.fa-exclamation:before{content:"\f12a"}.fa-superscript:before{content:"\f12b"}.fa-subscript:before{content:"\f12c"}.fa-eraser:before{content:"\f12d"}.fa-puzzle-piece:before{content:"\f12e"}.fa-microphone:before{content:"\f130"}.fa-microphone-slash:before{content:"\f131"}.fa-shield:before{content:"\f132"}.fa-calendar-o:before{content:"\f133"}.fa-fire-extinguisher:before{content:"\f134"}.fa-rocket:before{content:"\f135"}.fa-maxcdn:before{content:"\f136"}.fa-chevron-circle-left:before{content:"\f137"}.fa-chevron-circle-right:before{content:"\f138"}.fa-chevron-circle-up:before{content:"\f139"}.fa-chevron-circle-down:before{content:"\f13a"}.fa-html5:before{content:"\f13b"}.fa-css3:before{content:"\f13c"}.fa-anchor:before{content:"\f13d"}.fa-unlock-alt:before{content:"\f13e"}.fa-bullseye:before{content:"\f140"}.fa-ellipsis-h:before{content:"\f141"}.fa-ellipsis-v:before{content:"\f142"}.fa-rss-square:before{content:"\f143"}.fa-play-circle:before{content:"\f144"}.fa-ticket:before{content:"\f145"}.fa-minus-square:before{content:"\f146"}.fa-minus-square-o:before{content:"\f147"}.fa-level-up:before{content:"\f148"}.fa-level-down:before{content:"\f149"}.fa-check-square:before{content:"\f14a"}.fa-pencil-square:before{content:"\f14b"}.fa-external-link-square:before{content:"\f14c"}.fa-share-square:before{content:"\f14d"}.fa-compass:before{content:"\f14e"}.fa-toggle-down:before,.fa-caret-square-o-down:before{content:"\f150"}.fa-toggle-up:before,.fa-caret-square-o-up:before{content:"\f151"}.fa-toggle-right:before,.fa-caret-square-o-right:before{content:"\f152"}.fa-euro:before,.fa-eur:before{content:"\f153"}.fa-gbp:before{content:"\f154"}.fa-dollar:before,.fa-usd:before{content:"\f155"}.fa-rupee:before,.fa-inr:before{content:"\f156"}.fa-cny:before,.fa-rmb:before,.fa-yen:before,.fa-jpy:before{content:"\f157"}.fa-ruble:before,.fa-rouble:before,.fa-rub:before{content:"\f158"}.fa-won:before,.fa-krw:before{content:"\f159"}.fa-bitcoin:before,.fa-btc:before{content:"\f15a"}.fa-file:before{content:"\f15b"}.fa-file-text:before{content:"\f15c"}.fa-sort-alpha-asc:before{content:"\f15d"}.fa-sort-alpha-desc:before{content:"\f15e"}.fa-sort-amount-asc:before{content:"\f160"}.fa-sort-amount-desc:before{content:"\f161"}.fa-sort-numeric-asc:before{content:"\f162"}.fa-sort-numeric-desc:before{content:"\f163"}.fa-thumbs-up:before{content:"\f164"}.fa-thumbs-down:before{content:"\f165"}.fa-youtube-square:before{content:"\f166"}.fa-youtube:before{content:"\f167"}.fa-xing:before{content:"\f168"}.fa-xing-square:before{content:"\f169"}.fa-youtube-play:before{content:"\f16a"}.fa-dropbox:before{content:"\f16b"}.fa-stack-overflow:before{content:"\f16c"}.fa-instagram:before{content:"\f16d"}.fa-flickr:before{content:"\f16e"}.fa-adn:before{content:"\f170"}.fa-bitbucket:before{content:"\f171"}.fa-bitbucket-square:before{content:"\f172"}.fa-tumblr:before{content:"\f173"}.fa-tumblr-square:before{content:"\f174"}.fa-long-arrow-down:before{content:"\f175"}.fa-long-arrow-up:before{content:"\f176"}.fa-long-arrow-left:before{content:"\f177"}.fa-long-arrow-right:before{content:"\f178"}.fa-apple:before{content:"\f179"}.fa-windows:before{content:"\f17a"}.fa-android:before{content:"\f17b"}.fa-linux:before{content:"\f17c"}.fa-dribbble:before{content:"\f17d"}.fa-skype:before{content:"\f17e"}.fa-foursquare:before{content:"\f180"}.fa-trello:before{content:"\f181"}.fa-female:before{content:"\f182"}.fa-male:before{content:"\f183"}.fa-gittip:before{content:"\f184"}.fa-sun-o:before{content:"\f185"}.fa-moon-o:before{content:"\f186"}.fa-archive:before{content:"\f187"}.fa-bug:before{content:"\f188"}.fa-vk:before{content:"\f189"}.fa-weibo:before{content:"\f18a"}.fa-renren:before{content:"\f18b"}.fa-pagelines:before{content:"\f18c"}.fa-stack-exchange:before{content:"\f18d"}.fa-arrow-circle-o-right:before{content:"\f18e"}.fa-arrow-circle-o-left:before{content:"\f190"}.fa-toggle-left:before,.fa-caret-square-o-left:before{content:"\f191"}.fa-dot-circle-o:before{content:"\f192"}.fa-wheelchair:before{content:"\f193"}.fa-vimeo-square:before{content:"\f194"}.fa-turkish-lira:before,.fa-try:before{content:"\f195"}.fa-plus-square-o:before{content:"\f196"}.fa-space-shuttle:before{content:"\f197"}.fa-slack:before{content:"\f198"}.fa-envelope-square:before{content:"\f199"}.fa-wordpress:before{content:"\f19a"}.fa-openid:before{content:"\f19b"}.fa-institution:before,.fa-bank:before,.fa-university:before{content:"\f19c"}.fa-mortar-board:before,.fa-graduation-cap:before{content:"\f19d"}.fa-yahoo:before{content:"\f19e"}.fa-google:before{content:"\f1a0"}.fa-reddit:before{content:"\f1a1"}.fa-reddit-square:before{content:"\f1a2"}.fa-stumbleupon-circle:before{content:"\f1a3"}.fa-stumbleupon:before{content:"\f1a4"}.fa-delicious:before{content:"\f1a5"}.fa-digg:before{content:"\f1a6"}.fa-pied-piper:before{content:"\f1a7"}.fa-pied-piper-alt:before{content:"\f1a8"}.fa-drupal:before{content:"\f1a9"}.fa-joomla:before{content:"\f1aa"}.fa-language:before{content:"\f1ab"}.fa-fax:before{content:"\f1ac"}.fa-building:before{content:"\f1ad"}.fa-child:before{content:"\f1ae"}.fa-paw:before{content:"\f1b0"}.fa-spoon:before{content:"\f1b1"}.fa-cube:before{content:"\f1b2"}.fa-cubes:before{content:"\f1b3"}.fa-behance:before{content:"\f1b4"}.fa-behance-square:before{content:"\f1b5"}.fa-steam:before{content:"\f1b6"}.fa-steam-square:before{content:"\f1b7"}.fa-recycle:before{content:"\f1b8"}.fa-automobile:before,.fa-car:before{content:"\f1b9"}.fa-cab:before,.fa-taxi:before{content:"\f1ba"}.fa-tree:before{content:"\f1bb"}.fa-spotify:before{content:"\f1bc"}.fa-deviantart:before{content:"\f1bd"}.fa-soundcloud:before{content:"\f1be"}.fa-database:before{content:"\f1c0"}.fa-file-pdf-o:before{content:"\f1c1"}.fa-file-word-o:before{content:"\f1c2"}.fa-file-excel-o:before{content:"\f1c3"}.fa-file-powerpoint-o:before{content:"\f1c4"}.fa-file-photo-o:before,.fa-file-picture-o:before,.fa-file-image-o:before{content:"\f1c5"}.fa-file-zip-o:before,.fa-file-archive-o:before{content:"\f1c6"}.fa-file-sound-o:before,.fa-file-audio-o:before{content:"\f1c7"}.fa-file-movie-o:before,.fa-file-video-o:before{content:"\f1c8"}.fa-file-code-o:before{content:"\f1c9"}.fa-vine:before{content:"\f1ca"}.fa-codepen:before{content:"\f1cb"}.fa-jsfiddle:before{content:"\f1cc"}.fa-life-bouy:before,.fa-life-buoy:before,.fa-life-saver:before,.fa-support:before,.fa-life-ring:before{content:"\f1cd"}.fa-circle-o-notch:before{content:"\f1ce"}.fa-ra:before,.fa-rebel:before{content:"\f1d0"}.fa-ge:before,.fa-empire:before{content:"\f1d1"}.fa-git-square:before{content:"\f1d2"}.fa-git:before{content:"\f1d3"}.fa-hacker-news:before{content:"\f1d4"}.fa-tencent-weibo:before{content:"\f1d5"}.fa-qq:before{content:"\f1d6"}.fa-wechat:before,.fa-weixin:before{content:"\f1d7"}.fa-send:before,.fa-paper-plane:before{content:"\f1d8"}.fa-send-o:before,.fa-paper-plane-o:before{content:"\f1d9"}.fa-history:before{content:"\f1da"}.fa-circle-thin:before{content:"\f1db"}.fa-header:before{content:"\f1dc"}.fa-paragraph:before{content:"\f1dd"}.fa-sliders:before{content:"\f1de"}.fa-share-alt:before{content:"\f1e0"}.fa-share-alt-square:before{content:"\f1e1"}.fa-bomb:before{content:"\f1e2"}.fa-soccer-ball-o:before,.fa-futbol-o:before{content:"\f1e3"}.fa-tty:before{content:"\f1e4"}.fa-binoculars:before{content:"\f1e5"}.fa-plug:before{content:"\f1e6"}.fa-slideshare:before{content:"\f1e7"}.fa-twitch:before{content:"\f1e8"}.fa-yelp:before{content:"\f1e9"}.fa-newspaper-o:before{content:"\f1ea"}.fa-wifi:before{content:"\f1eb"}.fa-calculator:before{content:"\f1ec"}.fa-paypal:before{content:"\f1ed"}.fa-google-wallet:before{content:"\f1ee"}.fa-cc-visa:before{content:"\f1f0"}.fa-cc-mastercard:before{content:"\f1f1"}.fa-cc-discover:before{content:"\f1f2"}.fa-cc-amex:before{content:"\f1f3"}.fa-cc-paypal:before{content:"\f1f4"}.fa-cc-stripe:before{content:"\f1f5"}.fa-bell-slash:before{content:"\f1f6"}.fa-bell-slash-o:before{content:"\f1f7"}.fa-trash:before{content:"\f1f8"}.fa-copyright:before{content:"\f1f9"}.fa-at:before{content:"\f1fa"}.fa-eyedropper:before{content:"\f1fb"}.fa-paint-brush:before{content:"\f1fc"}.fa-birthday-cake:before{content:"\f1fd"}.fa-area-chart:before{content:"\f1fe"}.fa-pie-chart:before{content:"\f200"}.fa-line-chart:before{content:"\f201"}.fa-lastfm:before{content:"\f202"}.fa-lastfm-square:before{content:"\f203"}.fa-toggle-off:before{content:"\f204"}.fa-toggle-on:before{content:"\f205"}.fa-bicycle:before{content:"\f206"}.fa-bus:before{content:"\f207"}.fa-ioxhost:before{content:"\f208"}.fa-angellist:before{content:"\f209"}.fa-cc:before{content:"\f20a"}.fa-shekel:before,.fa-sheqel:before,.fa-ils:before{content:"\f20b"}.fa-meanpath:before{content:"\f20c"}</style><style class="darkreader darkreader--sync" media="screen"></style>
    
    <!-- add highlight -->
    <link rel="stylesheet" href="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/androidstudio.css"><style class="darkreader darkreader--sync" media="screen"></style>
		<script src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/jquery.nav.js.download"></script><script src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/fastclick.min.js.download"></script><script src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/hm.js.download"></script><script src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/anchor.min.js.download"></script><script type="text/javascript" src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/highlight.pack.js.download"></script><style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #574720 !important;
    border-color: #b3a266 !important;
    color: #e4ddcc !important;
}</style>
		<script>hljs.initHighlightingOnLoad();</script>
		
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="" data-gr-c-s-loaded="true">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://gityuan.com/">Gityuan</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://gityuan.com/">首页</a></li>
                    <li><a href="http://gityuan.com/archive">目录</a></li>
                    <!--<li><a href="/tags">标签</a></li>-->
                    <li><a href="http://gityuan.com/talk">留言区</a></li>
                    <li><a href="http://gityuan.com/about">关于</a></li>
                    <li><a href="http://gityuan.com/friends">友链</a></li>
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- _posts目录文章布局-->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/');
    }

    
</style><style class="darkreader darkreader--sync" media="screen"></style>
<header class="intro-header">
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a target="_blank" class="tag" href="http://gityuan.com/tags/#android" title="android">android</a>
                        
                        <a target="_blank" class="tag" href="http://gityuan.com/tags/#linux" title="linux">linux</a>
                        
                    </div>
                    <h1 id="linuxsyscall">Linux系统调用(syscall)原理</h1>
                    
                    
                    <h2 class="subheading" id=""></h2>
                    
                    <span class="meta">Posted by Gityuan on May 21, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

								<blockquote>
  <p>引言：分析Android源码的过程中，要想从上至下完全明白一行代码，往往涉及app、framework、native一直到kernel，可能迷失到代码世界，明白了系统调用原理，或许能帮你峰回路转，找到进入kernel函数的入口。本文主要讲解ARM架构相关源码：</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec">/bionic/libc/kernel/uapi/<span class="hljs-keyword">asm</span>-arm/<span class="hljs-keyword">asm</span>/unistd.h
/bionic/libc/arch-arm/syscalls/kill.S

/kernel/arch/arm/kernel/calls.S
/kernel/arch/arm/include/Uapi/<span class="hljs-keyword">asm</span>/unistd.h
/kernel/include/uapi/<span class="hljs-keyword">asm</span>-generic/unistd.h
/kernel/include/linux/syscalls.h
/kernel/kernel/signal.c
/kernel/arch/arm/kernel/entry-common.S
/kernelarch/arm/kernel/entry-armv.S
</code></pre></div></div>

<h2 id="一syscall意义">一、Syscall意义<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#%E4%B8%80syscall%E6%84%8F%E4%B9%89" aria-label="Anchor link for: 一syscall意义" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h2>

<p>内核提供用户空间程序与内核空间进行交互的一套标准接口，这些接口让用户态程序能<strong>受限</strong>访问硬件设备，比如申请系统资源，操作设备读写，创建新进程等。用户空间发生请求，内核空间负责执行，这些接口便是用户空间和内核空间共同识别的桥梁，这里提到两个字“受限”，是由于为了保证内核稳定性，而不能让用户空间程序随意更改系统，必须是内核对外开放的且满足权限的程序才能调用相应接口。</p>

<p>在用户空间和内核空间之间，有一个叫做Syscall(系统调用, system call)的中间层，是连接用户态和内核态的桥梁。这样即提高了内核的安全型，也便于移植，只需实现同一套接口即可。Linux系统，用户空间通过向内核空间发出Syscall，产生软中断，从而让程序陷入内核态，执行相应的操作。对于每个系统调用都会有一个对应的系统调用号，比很多操作系统要少很多。</p>

<p>安全性与稳定性：内核驻留在受保护的地址空间，用户空间程序无法直接执行内核代码，也无法访问内核数据，通过系统调用</p>

<p>性能：Linux上下文切换时间很短，以及系统调用处理过程非常精简，内核优化得好，所以性能上往往比很多其他操作系统执行要好。</p>

<h2 id="二syscall查找方式">二、Syscall查找方式<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#%E4%BA%8Csyscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F" aria-label="Anchor link for: 二syscall查找方式" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h2>

<p>这里以文章<a href="http://gityuan.com/2016/04/16/kill-signal/">理解杀进程的实现原理</a>中的kill()方法为例子，来找一找kill()方法系统调用的过程。</p>

<p><strong>Tips 1：</strong> 用户空间的方法<code class="highlighter-rouge">xxx</code>，对应系统调用层方法则是<code class="highlighter-rouge">sys_xxx</code>；  <br>
<strong>Tips 2：</strong> <code class="highlighter-rouge">unistd.h</code>文件记录着系统调用中断号的信息。</p>

<p>故用户空间<code class="highlighter-rouge">kill</code>方法则对应系统调用层便是<code class="highlighter-rouge">sys_kill</code>，这个方法去哪里找呢？从<code class="highlighter-rouge">/kernel/include/uapi/asm-generic/unistd.h</code>等还有很多<code class="highlighter-rouge">unistd.h</code>去慢慢查看，查看关键字<code class="highlighter-rouge">sys_kill</code>，便能看到下面几行：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs markdown">/<span class="hljs-bullet">* kernel/signal.c *</span>/
<span class="hljs-strong">__SYSCALL(__</span>NR<span class="hljs-emphasis">_kill, sys_</span>kill)
</code></pre></div></div>

<p>根据这个能得到一丝线索，那就是kill对应的方法sys_kill位于<code class="highlighter-rouge">/kernel/signal.c</code>文件。</p>

<p><strong>Tips 3：</strong> 宏定义SYSCALL_DEFINEx(xxx,…)，展开后对应的方法则是<code class="highlighter-rouge">sys_xxx</code>；  <br>
<strong>Tips 4：</strong> 方法参数的个数x，对应于SYSCALL_DEFINEx。</p>

<p><code class="highlighter-rouge">kill(int pid, int sig)</code>方法共两个参数，则对应方法于<code class="highlighter-rouge">SYSCALL_DEFINE2(kill,...)</code>，进入signal.c文件，再次搜索关键字，便能看到方法：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec">SYS<span class="hljs-built_in">CALL_DEFINE2</span>(kill, pid_t, pid, <span class="hljs-keyword">int</span>, sig)
{
    <span class="hljs-keyword">struct</span> siginfo info;
    info.si_signo = sig;
    info.si_errno = <span class="hljs-number">0</span>;
    info.si_code = SI_USER;
    info.si_pid = task_tgid_vnr(current);
    info.si_uid = from_kuid_munged(current_user_ns(), current_uid());
    <span class="hljs-keyword">return</span> kill_something_info(sig, &amp;info, pid);
}
</code></pre></div></div>

<p><code class="highlighter-rouge">SYSCALL_DEFINE2(kill, pid_t, pid, int, sig)</code> 基本等价于 <code class="highlighter-rouge">asmlinkage long sys_kill(int pid, int sig)</code>，这里用的是基本等价，往下看会解释原因。</p>

<h4 id="实用技巧">实用技巧<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7" aria-label="Anchor link for: 实用技巧" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h4>

<p>比如kill命令, 有两个参数. 则可以直接在kernel目录下搜索 “SYSCALL_DEFINE2(kill”,即可直接找到,所有对应的Syscall方法位于signal.c</p>

<h2 id="三syscall流程">三、Syscall流程<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#%E4%B8%89syscall%E6%B5%81%E7%A8%8B" aria-label="Anchor link for: 三syscall流程" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h2>

<p>Syscall是通过中断方式实现的，ARM平台上通过swi中断来实现系统调用，实现从用户态切换到内核态，发送软中断swi时，从中断向量表中查看跳转代码，其中异常向量表定义在文件/kernelarch/arm/kernel/entry-armv.S(汇编语言文件)。当执行系统调用时会根据系统调用号从系统调用表中来查看目标函数的入口地址，在calls.S文件中声明了入口地址信息。</p>

<p><strong>总体流程：</strong>kill() -&gt;  kill.S -&gt; swi陷入内核态 -&gt; 从sys_call_table查看到sys_kill -&gt; ret_fast_syscall -&gt; 回到用户态执行kill()下一行代码。 下面介绍部分核心流程：</p>

<p><strong>3.1：</strong> 用户程序通过软中断swi指令切入内核态，执行vector_swi处的指令。<code class="highlighter-rouge">vector_swi</code>在文件<code class="highlighter-rouge">/kenel/arch/arm/kernel/entry-common.S</code>中定义，此处省略。像每一个异常处理程序一样，要做的第一件事当然就是保护现场了。紧接着是获得系统调用的系统调用号</p>

<p><strong>3.2：</strong> 仍以kill()函数为例，来详细说说Syscall调用流程，用户空间kill()定义位于文件<code class="highlighter-rouge">kill.S</code>。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs bash"><span class="hljs-comment">#include &lt;private/bionic_asm.h&gt;</span>
ENTRY(<span class="hljs-built_in">kill</span>)
    mov     ip, r7
    ldr     r7, =__NR_<span class="hljs-built_in">kill</span>
    swi     <span class="hljs-comment">#0</span>
    mov     r7, ip
    cmn     r0, <span class="hljs-comment">#(MAX_ERRNO + 1)</span>
    bxls    lr
    neg     r0, r0
    b       __<span class="hljs-built_in">set</span>_errno_internal
END(<span class="hljs-built_in">kill</span>)
</code></pre></div></div>

<p>当调用kill时, 系统先保存r7内容, 然后将__NR_kill值放入r7, 再执行swi软中断指令切换进内核态。</p>

<p><strong>3.3：</strong> Linux内核中，每个Syscall都有唯一的系统调用号对应，kill的系统调用号为__NR_kill，用户空间的系统调用号定义于<code class="highlighter-rouge">/bionic/libc/kernel/uapi/asm-generic/unistd.h</code>，如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __NR_kill (__NR_SYSCALL_BASE + 37)</span>
</code></pre></div></div>

<p>其中__NR_SYSCALL_BASE=0，也就是__NR_kill系统调用号=37。</p>

<p><strong>3.4：</strong> 在内核中有与系统调用号对应的系统调用表，定义在文件<code class="highlighter-rouge">/kernel/arch/arm/kernel/calls.S</code>，如下：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec"><span class="hljs-comment">/* 35 */</span>    <span class="hljs-built_in">CALL</span>(sys_ni_syscall)        <span class="hljs-comment">/* was sys_ftime */</span>
            <span class="hljs-built_in">CALL</span>(sys_sync)
            <span class="hljs-built_in">CALL</span>(sys_kill)  <span class="hljs-comment">//此处为37号</span>
            <span class="hljs-built_in">CALL</span>(sys_rename)
            <span class="hljs-built_in">CALL</span>(sys_mkdir)
</code></pre></div></div>

<p>到这里可知37号系统调用对应sys_kill()，该方法所对应的函数声明在syscalls.h文件</p>

<p><strong>3.5：</strong> 文件<code class="highlighter-rouge">/kernel/include/linux/syscalls.h</code>中有如下声明：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs java"><span class="hljs-function">asmlinkage <span class="hljs-keyword">long</span> <span class="hljs-title">sys_kill</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pid, <span class="hljs-keyword">int</span> sig)</span></span>;
</code></pre></div></div>

<p>asmlinkage是gcc标签，代表函数读取的参数来自于栈中，而非寄存器。</p>

<h4 id="31-syscall_define">3.1 SYSCALL_DEFINE<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#31-syscall_define" aria-label="Anchor link for: 31 syscall_define" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h4>

<p>sys_kill()定义在内核源码找不到直接定义，而是通过<code class="highlighter-rouge">syscalls.h</code>文件中的SYSCALL_DEFINE宏定义。前面已经讲过sys_kill是通过语句<code class="highlighter-rouge">SYSCALL_DEFINE2(kill, pid_t, pid, int, sig)</code>来定义，下面来一层层剖开，这条宏定义的真面目：</p>

<p><strong>等价 1：</strong></p>

<p><code class="highlighter-rouge">syscalls.h</code>中有大量如下宏定义：</p>

<pre><code class="language-C hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SYSCALL_DEFINE0(sname)                    \
    SYSCALL_METADATA(_##sname, 0);                \
    asmlinkage long sys_##sname(void)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SYSCALL_DEFINE1(name, ...) SYSCALL_DEFINEx(1, _##name, __VA_ARGS__)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SYSCALL_DEFINE2(name, ...) SYSCALL_DEFINEx(2, _##name, __VA_ARGS__)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SYSCALL_DEFINE3(name, ...) SYSCALL_DEFINEx(3, _##name, __VA_ARGS__)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SYSCALL_DEFINE4(name, ...) SYSCALL_DEFINEx(4, _##name, __VA_ARGS__)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SYSCALL_DEFINE5(name, ...) SYSCALL_DEFINEx(5, _##name, __VA_ARGS__)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SYSCALL_DEFINE6(name, ...) SYSCALL_DEFINEx(6, _##name, __VA_ARGS__)</span>
</code></pre>

<p>可得出原语句等价：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec">SYS<span class="hljs-built_in">CALL_DEFINEx</span>(<span class="hljs-number">2</span>, _kill, pid_t, pid, <span class="hljs-keyword">int</span>, sig)
</code></pre></div></div>

<p><strong>等价 2：</strong></p>

<p><code class="highlighter-rouge">syscalls.h</code>中有如下宏定义：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec"><span class="hljs-meta">#define SYSCALL_DEFINEx(x, sname, ...)                \</span>
    SYS<span class="hljs-built_in">CALL_METADATA</span>(sname, x, __VA_ARGS__)            \
    __SYS<span class="hljs-built_in">CALL_DEFINEx</span>(x, sname, __VA_ARGS__)
</code></pre></div></div>

<p>可得出原语句等价：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec">SYS<span class="hljs-built_in">CALL_METADATA</span>(_kill, <span class="hljs-number">2</span>, pid_t, pid, <span class="hljs-keyword">int</span>, sig)
__SYS<span class="hljs-built_in">CALL_DEFINEx</span>(<span class="hljs-number">2</span>, _kill, pid_t, pid, <span class="hljs-keyword">int</span>, sig)
</code></pre></div></div>

<p>define __SYSCALL_DEFINEx(x, name, …)</p>

<p><strong>等价 3：</strong></p>

<p><code class="highlighter-rouge">syscalls.h</code>中有如下宏定义：</p>

<pre><code class="language-C hljs"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> __SYSCALL_DEFINEx(x, name, ...)                    \
  asmlinkage long sys##name(__MAP(x,__SC_DECL,__VA_ARGS__))    \
      __attribute__((alias(__stringify(SyS##name))));        \
  static inline long SYSC##name(__MAP(x,__SC_DECL,__VA_ARGS__));    \
  asmlinkage long SyS##name(__MAP(x,__SC_LONG,__VA_ARGS__));    \
  asmlinkage long SyS##name(__MAP(x,__SC_LONG,__VA_ARGS__))    \
  {                                \
      long ret = SYSC##name(__MAP(x,__SC_CAST,__VA_ARGS__));    \
      __MAP(x,__SC_TEST,__VA_ARGS__);                \
      __PROTECT(x, ret,__MAP(x,__SC_ARGS,__VA_ARGS__));    \
      return ret;                        \
  }                                \
  static inline long SYSC##name(__MAP(x,__SC_DECL,__VA_ARGS__))</span>
</code></pre>

<p>可得出原语句等价：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs java"><span class="hljs-function">asmlinkage <span class="hljs-keyword">long</span> <span class="hljs-title">sys_kill</span><span class="hljs-params">(__MAP(<span class="hljs-number">2</span>,__SC_DECL,__VA_ARGS__)</span>)    \
    <span class="hljs-title">__attribute__</span><span class="hljs-params">((alias(__stringify(SyS_kill)</span>)))</span>;        \
<span class="hljs-function"><span class="hljs-keyword">static</span> inline <span class="hljs-keyword">long</span> <span class="hljs-title">SYSC_kill</span><span class="hljs-params">(__MAP(<span class="hljs-number">2</span>,__SC_DECL,__VA_ARGS__)</span>)</span>;    \
<span class="hljs-function">asmlinkage <span class="hljs-keyword">long</span> <span class="hljs-title">SyS_kill</span><span class="hljs-params">(__MAP(<span class="hljs-number">2</span>,__SC_LONG,__VA_ARGS__)</span>)</span>;    \
<span class="hljs-function">asmlinkage <span class="hljs-keyword">long</span> <span class="hljs-title">SyS_kill</span><span class="hljs-params">(__MAP(<span class="hljs-number">2</span>,__SC_LONG,__VA_ARGS__)</span>)    \
</span>{                                \
    <span class="hljs-keyword">long</span> ret = SYSC_kill(__MAP(<span class="hljs-number">2</span>,__SC_CAST,__VA_ARGS__));    \
    __MAP(<span class="hljs-number">2</span>,__SC_TEST,__VA_ARGS__);                \
    __PROTECT(<span class="hljs-number">2</span>, ret,__MAP(<span class="hljs-number">2</span>,__SC_ARGS,__VA_ARGS__));    \
    <span class="hljs-keyword">return</span> ret;                        \
}                                \
<span class="hljs-function"><span class="hljs-keyword">static</span> inline <span class="hljs-keyword">long</span> <span class="hljs-title">SYSC_kill</span><span class="hljs-params">(__MAP(<span class="hljs-number">2</span>,__SC_DECL,__VA_ARGS__)</span>)
</span></code></pre></div></div>

<p>这里<code class="highlighter-rouge">__VA_ARGS__</code>等于 <code class="highlighter-rouge">pid_t, pid, int, sig</code>。</p>

<p><strong>等价 4:</strong></p>

<p>先说说这里涉及的宏定义</p>

<p>__MAP宏定义：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs ini"><span class="hljs-comment">#define __MAP0(m,...)</span>
<span class="hljs-comment">#define __MAP1(m,t,a) m(t,a)</span>
<span class="hljs-comment">#define __MAP2(m,t,a,...) m(t,a), __MAP1(m,__VA_ARGS__)</span>
<span class="hljs-comment">#define __MAP3(m,t,a,...) m(t,a), __MAP2(m,__VA_ARGS__)</span>
<span class="hljs-comment">#define __MAP4(m,t,a,...) m(t,a), __MAP3(m,__VA_ARGS__)</span>
<span class="hljs-comment">#define __MAP5(m,t,a,...) m(t,a), __MAP4(m,__VA_ARGS__)</span>
<span class="hljs-comment">#define __MAP6(m,t,a,...) m(t,a), __MAP5(m,__VA_ARGS__)</span>
<span class="hljs-comment">#define __MAP(n,...) __MAP##n(__VA_ARGS__)</span>
</code></pre></div></div>

<p>相关宏定义：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs ini"><span class="hljs-comment">#define __SC_DECL(t, a)    t a</span>
<span class="hljs-comment">#define __SC_LONG(t, a) __typeof(__builtin_choose_expr(__TYPE_IS_LL(t), 0LL, 0L)) a</span>
<span class="hljs-comment">#define __SC_CAST(t, a)    (t) a</span>
<span class="hljs-comment">#define __SC_ARGS(t, a)    a</span>
<span class="hljs-comment">#define __SC_TEST(t, a) (void)BUILD_BUG_ON_ZERO(!__TYPE_IS_LL(t) &amp;&amp; sizeof(t) &gt; sizeof(long))</span>
</code></pre></div></div>

<p>展开：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec">__MAP(<span class="hljs-number">2</span>,__SC_DECL, pid_t, pid, <span class="hljs-keyword">int</span>, sig) <span class="hljs-comment">//等价于 pid_t pid, int sig</span>
__MAP(<span class="hljs-number">2</span>,__SC_LONG,__VA_ARGS__) <span class="hljs-comment">//等价于 long pid, long sig</span>
__MAP(<span class="hljs-number">2</span>,__SC_<span class="hljs-built_in">CAST</span>,__VA_ARGS__) <span class="hljs-comment">//等价于 (pid_t) pid, (int)sig</span>
__MAP(<span class="hljs-number">2</span>,__SC_ARGS,__VA_ARGS__) <span class="hljs-comment">//等价于 pid, sig</span>
</code></pre></div></div>

<p>可得出原语句等价：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs objectivec"><span class="hljs-comment">//函数声明sys_kill()，并别名指向SyS_kill</span>
asmlinkage <span class="hljs-keyword">long</span> sys_kill(pid_t pid, <span class="hljs-keyword">int</span> sig) __attribute__((alias(__stringify(SyS_kill))));
<span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">long</span> SYSC_kill(pid_t pid, <span class="hljs-keyword">int</span> sig);

<span class="hljs-comment">//函数声明SyS_kill()</span>
asmlinkage <span class="hljs-keyword">long</span> SyS_kill(<span class="hljs-keyword">long</span> pid, <span class="hljs-keyword">long</span> sig);
asmlinkage <span class="hljs-keyword">long</span> SyS_kill(<span class="hljs-keyword">long</span> pid, <span class="hljs-keyword">long</span> sig)
{
    <span class="hljs-keyword">long</span> ret = SYSC_kill((pid_t) pid, (<span class="hljs-keyword">int</span>)sig);
    B<span class="hljs-built_in">UILD_BUG_ON_ZERO</span>(<span class="hljs-keyword">sizeof</span>(pid_t) &gt; <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">long</span>));
    B<span class="hljs-built_in">UILD_BUG_ON_ZERO</span>(<span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">int</span>) &gt; <span class="hljs-keyword">sizeof</span>(<span class="hljs-keyword">long</span>));
    __PROTECT(<span class="hljs-number">2</span>, ret, pid, sig);
    <span class="hljs-keyword">return</span> ret;
}
<span class="hljs-keyword">static</span> <span class="hljs-keyword">inline</span> <span class="hljs-keyword">long</span> SYSC_kill(pid_t pid, <span class="hljs-keyword">int</span> sig)
</code></pre></div></div>

<p>通过以上分析过程：</p>

<ul>
  <li>kill添加了<code class="highlighter-rouge">sys_</code>前缀，声明sys_kill()函数；</li>
  <li>定义SYSC_kill()函数和SyS_kill()函数；</li>
  <li>sys_kill，通过别名机制等同于SyS_kill().</li>
</ul>

<p>看到这或许很多人(包括我)会觉得诧异，为何要如此复杂呢，后来查资料，发现这是由于之前64位Linux存在<code class="highlighter-rouge">CVE-2009-2009</code>的漏洞，简单说就是32位参数存放在64位寄存器，修改符号扩展可能导致产生一个非法内存地址，从而导致系统崩溃或者提升权限。 为了修复这个问题，把寄存器高位清零即可，但做起来比较困难，为了做尽可能少的修改，将调用参数统一采用使用long型来接收，再强转为相应参数。 窥见一斑，可见Linux大师们精湛的宏定义，已经用得出神入化。</p>

<p>如果觉得很复杂，那么可以忽略这个宏定义，只要记住<code class="highlighter-rouge">SYSCALL_DEFINE2(kill, pid_t, pid, int, sig)</code> 基本等价于 <code class="highlighter-rouge">asmlinkage long sys_kill(int pid, int sig)</code> 就足够了。</p>

<h2 id="四总结">四、总结<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#%E5%9B%9B%E6%80%BB%E7%BB%93" aria-label="Anchor link for: 四总结" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h2>

<h4 id="41-内核空间">4.1 内核空间<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#41-%E5%86%85%E6%A0%B8%E7%A9%BA%E9%97%B4" aria-label="Anchor link for: 41 内核空间" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h4>

<ol>
  <li>系统调用的函数原型的指针：位于文件/kernel/arch/arm/kernel/calls.S，格式为<code class="highlighter-rouge">CALL(sys_xxx)</code>，指定了目标函数的入口地址。</li>
  <li>系统调用号的宏定义：位于文件/kernel/arch/arm/include/Uapi/asm/unistd.h，记录着<strong>内核空间的系统调用号</strong>，格式为<code class="highlighter-rouge">#define__NR_xxx   (__NR_SYSCALL_BASE+[num])</code></li>
  <li>系统调用的函数声明：位于文件/kernel/include/linux/syscalls.h，格式为<code class="highlighter-rouge">asmlinkage long sys_xxx(args ...);</code></li>
  <li>系统调用的函数实现：不同函数位于不同文件，比如kill()位于/kernel/kernel/signal.c文件，格式为<code class="highlighter-rouge">SYSCALL_DEFINEx(x, sname, ...)</code></li>
</ol>

<p>前面这4步都是在内核空间相关的文件定义，有了这些，那么内核就可以使用相应的系统调用号。</p>

<h4 id="42-用户空间">4.2 用户空间<a class="anchorjs-link " href="http://gityuan.com/2016/05/21/syscall/#42-%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4" aria-label="Anchor link for: 42 用户空间" data-anchorjs-icon="#" style="opacity: 1; padding-left: 0.375em;"></a></h4>

<ol>
  <li>
    <p>系统调用号的宏定义：位于文件/bionic/libc/kernel/uapi/asm-arm/asm/unistd.h，记录着<strong>用户空间的系统调用号</strong>，格式为<code class="highlighter-rouge">#define__NR_xxx   (__NR_SYSCALL_BASE+[num])</code>。这个文件就是由内核空间同名的头文件自动生成的，所以该文件与内核空间的系统调用号是完全一致。</p>
  </li>
  <li>
    <p>汇编定义相关函数的中断调用过程：位于文件/bionic/libc/arch-arm/syscalls/xxx.S，比如kill()位于kill.S，格式为：</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code class="hljs bash"> ENTRY(xxx)
     mov     ip, r7
     ldr     r7, =__NR_xxx
     swi     <span class="hljs-comment">#0</span>
     mov     r7, ip
     cmn     r0, <span class="hljs-comment">#(MAX_ERRNO + 1)</span>
     bxls    lr
     neg     r0, r0
     b       __<span class="hljs-built_in">set</span>_errno_internal
 END(xxx)
</code></pre></div>    </div>
  </li>
</ol>

<p>当然kill()方法还有函数声明，有了这些，用户空间也能在程序中使用系统调用。明白了这些过程，那么自己新添加系统调用其实也并不是多困难的一件事，新增系统调用号还需要修改syscalls总个数，但强烈不建议自己新增系统调用号，尽量保持与linux kernel主线一致，兼容性更好，所以就不进一步介绍新增流程了。</p>

								<hr>
								<a target="_blank" href="http://weibo.com/gityuan">
	<font color="#f57e42" data-darkreader-inline-color="" style="--darkreader-inline-color:#ad8067;"><strong>weibo.com/gityuan</strong></font>
</a>
<font color="#004B97" data-darkreader-inline-color="" style="--darkreader-inline-color:#93acbe;"><strong>微博关注  |  </strong></font>

<a target="_blank" href="http://gityuan.com/talk/">
	<font color="#f57e42" data-darkreader-inline-color="" style="--darkreader-inline-color:#ad8067;"><strong>留言区</strong></font>
</a>
<font color="#004B97" data-darkreader-inline-color="" style="--darkreader-inline-color:#93acbe;"><strong>技术交流  |  </strong></font>
<a target="_blank" href="http://gityuan.com/images/about-me/gityuan_pay.jpg">
	<font color="#f57e42" data-darkreader-inline-color="" style="--darkreader-inline-color:#ad8067;"><strong>¥打赏支持</strong></font>
</a>

                <hr>
								

                <ul class="pager">
                    
                    <li class="previous">
                        <a target="_blank" href="http://gityuan.com/2016/05/15/event-log/" data-toggle="tooltip" data-placement="top" title="Android EventLog含义">
                        上一篇<br>
                        <span>Android EventLog含义</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a target="_blank" href="http://gityuan.com/2016/05/28/android-jni/" data-toggle="tooltip" data-placement="top" title="Android JNI原理分析">
                        下一篇<br>
                        <span>Android JNI原理分析</span>
                        </a>
                    </li>
                    
                </ul>


                

            </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5 id="catalog">
                        <a class="catalog-toggle" href="http://gityuan.com/2016/05/21/syscall/#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"><li class="h2_nav active"><a href="http://gityuan.com/2016/05/21/syscall/#%E4%B8%80syscall%E6%84%8F%E4%B9%89" rel="nofollow">一、Syscall意义</a></li><li class="h2_nav"><a href="http://gityuan.com/2016/05/21/syscall/#%E4%BA%8Csyscall%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F" rel="nofollow">二、Syscall查找方式</a></li><li class="h4_nav"><a href="http://gityuan.com/2016/05/21/syscall/#%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7" rel="nofollow">实用技巧</a></li><li class="h2_nav"><a href="http://gityuan.com/2016/05/21/syscall/#%E4%B8%89syscall%E6%B5%81%E7%A8%8B" rel="nofollow">三、Syscall流程</a></li><li class="h4_nav"><a href="http://gityuan.com/2016/05/21/syscall/#31-syscall_define" rel="nofollow">3.1 SYSCALL_DEFINE</a></li><li class="h2_nav"><a href="http://gityuan.com/2016/05/21/syscall/#%E5%9B%9B%E6%80%BB%E7%BB%93" rel="nofollow">四、总结</a></li><li class="h4_nav"><a href="http://gityuan.com/2016/05/21/syscall/#41-%E5%86%85%E6%A0%B8%E7%A9%BA%E9%97%B4" rel="nofollow">4.1 内核空间</a></li><li class="h4_nav"><a href="http://gityuan.com/2016/05/21/syscall/#42-%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4" rel="nofollow">4.2 用户空间</a></li></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5 id="-1"><a target="_blank" href="http://gityuan.com/tags/">标签</a></h5>
                    <div class="tags">
                      
                            <a target="_blank" href="http://gityuan.com/tags/#android" title="android" rel="152">
                                    android
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E7%BB%84%E4%BB%B6%E7%B3%BB%E5%88%97" title="组件系列" rel="19">
                                    组件系列
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#else" title="else" rel="3">
                                    else
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#debug" title="debug" rel="19">
                                    debug
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E6%9D%83%E9%99%90" title="权限" rel="2">
                                    权限
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#web" title="web" rel="2">
                                    web
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#tool" title="tool" rel="12">
                                    tool
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#java" title="java" rel="12">
                                    java
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#performance" title="performance" rel="4">
                                    performance
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#app" title="app" rel="2">
                                    app
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#algorithm" title="algorithm" rel="1">
                                    algorithm
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E8%BF%9B%E7%A8%8B%E7%B3%BB%E5%88%97" title="进程系列" rel="13">
                                    进程系列
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E8%99%9A%E6%8B%9F%E6%9C%BA" title="虚拟机" rel="1">
                                    虚拟机
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#memory" title="memory" rel="5">
                                    memory
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#jvm" title="jvm" rel="5">
                                    jvm
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#linux" title="linux" rel="11">
                                    linux
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#binder" title="binder" rel="19">
                                    binder
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#ipc" title="ipc" rel="3">
                                    ipc
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#handler" title="handler" rel="3">
                                    handler
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#process" title="process" rel="6">
                                    process
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#power" title="power" rel="1">
                                    power
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8" title="系统启动" rel="6">
                                    系统启动
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#AMS" title="AMS" rel="2">
                                    AMS
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#PMS" title="PMS" rel="1">
                                    PMS
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E8%87%AA%E5%AD%A6%E7%BC%96%E7%A8%8B" title="自学编程" rel="1">
                                    自学编程
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#stability" title="stability" rel="8">
                                    stability
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E7%BB%84%E4%BB%B6" title="组件" rel="3">
                                    组件
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#art" title="art" rel="2">
                                    art
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#graphic" title="graphic" rel="1">
                                    graphic
                            </a>
                      
                            <a target="_blank" href="http://gityuan.com/tags/#%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B" title="实战案例" rel="7">
                                    实战案例
                            </a>
                      
                    </div>
                </section> 
                 

                <!-- Friends Blog -->
                <!-- 
                 -->
            </div>
        </div>
    </div>
</article>






<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style><style class="darkreader darkreader--sync" media="screen"></style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/gityuan">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/gityuan">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    
										
                    
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/gityuan">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://gityuan.com/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright © Gityuan  2019 | Powered by Jekyll with Hux Theme
                </p>
                <!-- 流量统计 -->
								<div style="display:none">
                                    <!--
									<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1000098804'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1000098804%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>-->
                                    
                                    <!-- Baidu Tongji -->
                                    <script>
                                    var _hmt = _hmt || [];
                                    (function() {
                                      var hm = document.createElement("script");
                                      hm.src = "https://hm.baidu.com/hm.js?3b1c71bfd9641a47009f87240c135d75";
                                      var s = document.getElementsByTagName("script")[0]; 
                                      s.parentNode.insertBefore(hm, s);
                                    })();
                                    </script>
								</div>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/jquery.min.js.download"></script>

<!-- Bootstrap Core JavaScript -->
<script src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/bootstrap.min.js.download"></script>

<!-- Custom Theme JavaScript -->
<script src="./Linux系统调用(syscall)原理 - Gityuan博客 _ 袁辉辉的Android博客_files/hux-blog.min.js.download"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>






</body></html>